cmake_minimum_required(VERSION 2.8)
project(DisplayCluster)
list(APPEND CMAKE_MODULE_PATH ${CMAKE_SOURCE_DIR}/CMake
                              ${CMAKE_SOURCE_DIR}/CMake/common)
include(GitExternal)

# Versioning
set(RELEASE_VERSION OFF) # OFF or ABI version
set(LAST_RELEASE 1.0.0)
set(VERSION_MAJOR 0)
set(VERSION_MINOR 3)
set(VERSION_PATCH 0)

# Scripts
set(DISPLAYCLUSTER_DESCRIPTION "The DisplayCluster project")
set(COMMON_PROJECT_DOMAIN ch.epfl.bluebrain)
set(DISPLAYCLUSTER_ISSUES_URL "https://bbpteam.epfl.ch/project/issues/browse/DISCL")
set(DISPLAYCLUSTER_PACKAGE_URL "https://github.com/BlueBrain/DisplayCluster/releases")
include(Common)
include(FindPackages) # Generated by Buildyard and checked in

# Remove preprocessor #error warnings of cppcheck which happen in PDF.cpp and PictureFlow.cpp.
# The -D option in TargetHooks.cmake seems to overwrites other #defines and causes the problem.
list(APPEND CPPCHECK_EXTRA_ARGS --suppress=preprocessorErrorDirective)

# Build options

# Fix for avutil: https://code.google.com/p/ffmpegsource/source/detail?r=311
add_definitions(-D__STDC_CONSTANT_MACROS)

if(OPENGL_FOUND AND MPI_FOUND AND FFMPEG_FOUND AND FCGI_FOUND)
  include_directories(SYSTEM ${MPI_INCLUDE_PATH})
  set(BUILD_CORE_LIBRARY ON)
endif()

if(TUIO_FOUND)
  option(ENABLE_TUIO_TOUCH_LISTENER "Enable TUIO touch listener for multi-touch events" ON)
endif()

option(ENABLE_JOYSTICK_SUPPORT "Enable joystick support" OFF)
option(ENABLE_SKELETON_SUPPORT "EXPERIMENTAL: Enable skeleton tracking interface support" OFF)
option(ENABLE_PYTHON_SUPPORT "Enable Python support" OFF)

if(POPPLER_FOUND)
  option(ENABLE_PDF_SUPPORT "Enable Pdf support using Poppler" ON)
endif()

include_directories(src)

# Targets
add_subdirectory(src)
add_subdirectory(apps)
add_subdirectory(tests)

# Documentation
set(PROJECT_INCLUDE_NAME dc)
include(DoxygenRule)
add_subdirectory(doc)

# Install example files
install(DIRECTORY examples DESTINATION . COMPONENT examples)
